{"version":3,"sources":["../../../../server/lib/squoosh/impl.ts"],"names":["decodeBuffer","rotate","resize","encodeJpeg","encodeWebp","encodeAvif","encodePng","FIXED_VERSION","DELAY_MS","_promise","delayOnce","ms","Promise","resolve","setTimeout","maybeDelay","isAppleM1","process","arch","platform","semver","lt","version","_buffer","Object","buffer","Buffer","from","firstChunk","slice","firstChunkString","Array","map","v","String","fromCodePoint","join","key","entries","supportedFormats","find","detectors","some","detector","exec","Error","encoder","mod","dec","rgba","decode","Uint8Array","image","numRotations","ImageData","m","preprocessors","instantiate","data","width","height","p","defaultOptions","quality","e","enc","r","encode","defaultEncoderOptions","val","autoOptimize","min","cqLevel","Math","round"],"mappings":"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"}